import React, { useState, useEffect } from 'react';
import { Link } from 'react-router-dom';
import { Offcanvas } from 'react-bootstrap';
import { useLocation, useNavigate } from 'react-router-dom';

const SidebarToggle = ({ openHistoryModal }) => {
    const [visible, setVisible] = useState(false);
    const [historyButtonShow, setHistoryButtonShow] = useState(false);
    var selectedTheme = localStorage.getItem('selectedTheme');

    // Check if the current URL is "/"
    const isRootHome = location.pathname === "/";
    const navigate = useNavigate()

    useEffect(() => {
        if (location.pathname === "/financeAndInvestment/tvmAdvancedCalculator" || location.pathname === "/loanMortgage/loanCalculator" || location.pathname === "/" || location.pathname === "/financeAndInvestment/tvmCalculator") {
            setHistoryButtonShow(true);
        } else {
            setHistoryButtonShow(false);
        }
    }, [location.pathname]);

    return (
        <nav className="navbar bg-light navbar-expand-xl navbar-light sticky-top">
            <div className="container-fluid">
                {isRootHome
                    ?
                    <button className="btn btn-sm btn-light menu-button" onClick={() => setVisible(true)}><strong>â˜°</strong></button >
                    :
                    <button onClick={() => navigate(-1)} className="btn btn-sm btn-light menu-button" >
                        <strong>ðŸ¡¨</strong>
                    </button>
                }
                {historyButtonShow ?
                    <button className="btn btn-sm btn-light" onClick={openHistoryModal}>
                        {selectedTheme === 'light' ? (
                            <svg width="20" height="20" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clipPath="url(#clip0_2_10)">
                                    <path d="M279.467 21.3333C227.877 21.5844 177.828 38.9423 137.161 70.6875C96.4944 102.433 67.5073 146.771 54.7414 196.757L39.1254 173.141C37.647 170.669 35.6832 168.521 33.3524 166.829C31.0216 165.136 28.372 163.932 25.5636 163.291C22.7551 162.65 19.8459 162.584 17.0113 163.098C14.1768 163.612 11.4756 164.694 9.07076 166.28C6.66589 167.866 4.60714 169.923 3.01865 172.326C1.43016 174.729 0.344845 177.429 -0.171854 180.263C-0.688553 183.097 -0.625928 186.006 0.0122448 188.815C0.650417 191.625 1.85092 194.275 3.54135 196.608L50.4747 267.733C53.7348 272.295 58.5415 275.517 64 276.8C69.5737 277.906 75.3589 276.796 80.128 273.707L150.528 226.283C152.955 224.767 155.053 222.778 156.696 220.435C158.339 218.092 159.493 215.442 160.091 212.644C160.689 209.845 160.717 206.955 160.175 204.145C159.633 201.335 158.53 198.663 156.934 196.288C155.338 193.913 153.28 191.883 150.883 190.32C148.486 188.756 145.799 187.691 142.982 187.187C140.165 186.684 137.275 186.752 134.485 187.388C131.695 188.025 129.062 189.216 126.741 190.891L94.72 212.48C103.242 177.886 121.317 146.383 146.882 121.567C172.447 96.7512 204.472 79.6208 239.305 72.1304C274.137 64.64 310.373 67.0914 343.88 79.2047C377.386 91.3181 406.812 112.606 428.802 140.639C450.792 168.672 464.459 202.321 468.244 237.748C472.03 273.175 465.781 308.953 450.211 340.999C434.641 373.046 410.376 400.07 380.186 418.99C349.996 437.909 315.095 447.962 279.467 448C248.925 447.918 218.854 440.462 191.811 426.266C164.768 412.071 141.553 391.555 124.139 366.464C122.579 364.069 120.554 362.012 118.184 360.415C115.814 358.818 113.147 357.713 110.342 357.166C107.537 356.62 104.65 356.642 101.854 357.233C99.0578 357.823 96.4087 358.97 94.064 360.604C91.7193 362.238 89.7268 364.327 88.2049 366.746C86.683 369.165 85.6627 371.865 85.2046 374.686C84.7464 377.507 84.8597 380.391 85.5378 383.168C86.2159 385.944 87.445 388.556 89.152 390.848C117.463 431.662 158.119 462.319 205.146 478.312C252.173 494.305 303.089 494.792 350.413 479.7C397.737 464.608 438.972 434.734 468.057 394.468C497.143 354.203 512.545 305.669 512 256C512.21 194.067 487.846 134.58 444.254 90.5874C400.661 46.5947 341.399 21.6889 279.467 21.3333Z" fill="black" />
                                    <path d="M277.333 126.933C271.675 126.933 266.249 129.181 262.248 133.182C258.248 137.182 256 142.609 256 148.267V256C256.091 261.639 258.326 267.032 262.251 271.083L326.251 335.659C330.267 339.612 335.668 341.839 341.303 341.867C346.938 341.895 352.361 339.721 356.416 335.808C360.432 331.824 362.702 326.409 362.726 320.752C362.75 315.095 360.526 309.66 356.544 305.643L298.667 247.232V148.267C298.667 142.609 296.419 137.182 292.418 133.182C288.417 129.181 282.991 126.933 277.333 126.933Z" fill="black" />
                                </g>
                                <defs>
                                    <clipPath id="clip0_2_10">
                                        <rect width="512" height="512" fill="white" />
                                    </clipPath>
                                </defs>
                            </svg>
                        ) : (
                            <svg width="20" height="20" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clipPath="url(#clip0_2_10)">
                                    <path d="M279.467 21.3333C227.877 21.5844 177.828 38.9423 137.161 70.6875C96.4944 102.433 67.5073 146.771 54.7414 196.757L39.1254 173.141C37.647 170.669 35.6832 168.521 33.3524 166.829C31.0216 165.136 28.372 163.932 25.5636 163.291C22.7551 162.65 19.8459 162.584 17.0113 163.098C14.1768 163.612 11.4756 164.694 9.07076 166.28C6.66589 167.866 4.60714 169.923 3.01865 172.326C1.43016 174.729 0.344845 177.429 -0.171854 180.263C-0.688553 183.097 -0.625928 186.006 0.0122448 188.815C0.650417 191.625 1.85092 194.275 3.54135 196.608L50.4747 267.733C53.7348 272.295 58.5415 275.517 64 276.8C69.5737 277.906 75.3589 276.796 80.128 273.707L150.528 226.283C152.955 224.767 155.053 222.778 156.696 220.435C158.339 218.092 159.493 215.442 160.091 212.644C160.689 209.845 160.717 206.955 160.175 204.145C159.633 201.335 158.53 198.663 156.934 196.288C155.338 193.913 153.28 191.883 150.883 190.32C148.486 188.756 145.799 187.691 142.982 187.187C140.165 186.684 137.275 186.752 134.485 187.388C131.695 188.025 129.062 189.216 126.741 190.891L94.72 212.48C103.242 177.886 121.317 146.383 146.882 121.567C172.447 96.7512 204.472 79.6208 239.305 72.1304C274.137 64.64 310.373 67.0914 343.88 79.2047C377.386 91.3181 406.812 112.606 428.802 140.639C450.792 168.672 464.459 202.321 468.244 237.748C472.03 273.175 465.781 308.953 450.211 340.999C434.641 373.046 410.376 400.07 380.186 418.99C349.996 437.909 315.095 447.962 279.467 448C248.925 447.918 218.854 440.462 191.811 426.266C164.768 412.071 141.553 391.555 124.139 366.464C122.579 364.069 120.554 362.012 118.184 360.415C115.814 358.818 113.147 357.713 110.342 357.166C107.537 356.62 104.65 356.642 101.854 357.233C99.0578 357.823 96.4087 358.97 94.064 360.604C91.7193 362.238 89.7268 364.327 88.2049 366.746C86.683 369.165 85.6627 371.865 85.2046 374.686C84.7464 377.507 84.8597 380.391 85.5378 383.168C86.2159 385.944 87.445 388.556 89.152 390.848C117.463 431.662 158.119 462.319 205.146 478.312C252.173 494.305 303.089 494.792 350.413 479.7C397.737 464.608 438.972 434.734 468.057 394.468C497.143 354.203 512.545 305.669 512 256C512.21 194.067 487.846 134.58 444.254 90.5874C400.661 46.5947 341.399 21.6889 279.467 21.3333Z" fill="white" />
                                    <path d="M277.333 126.933C271.675 126.933 266.249 129.181 262.248 133.182C258.248 137.182 256 142.609 256 148.267V256C256.091 261.639 258.326 267.032 262.251 271.083L326.251 335.659C330.267 339.612 335.668 341.839 341.303 341.867C346.938 341.895 352.361 339.721 356.416 335.808C360.432 331.824 362.702 326.409 362.726 320.752C362.75 315.095 360.526 309.66 356.544 305.643L298.667 247.232V148.267C298.667 142.609 296.419 137.182 292.418 133.182C288.417 129.181 282.991 126.933 277.333 126.933Z" fill="white" />
                                </g>
                                <defs>
                                    <clipPath id="clip0_2_10">
                                        <rect width="512" height="512" fill="black" />
                                    </clipPath>
                                </defs>
                            </svg>
                        )}
                    </button> : <div></div>
                }
                <Offcanvas className="bg-light text-dark" show={visible} onHide={() => setVisible(false)} placement="start">
                    <Offcanvas.Header closeButton>
                        <h5 className="offcanvas-title">Calculator</h5>
                    </Offcanvas.Header>
                    <Offcanvas.Body>
                        <div className="navbar-nav justify-content-end flex-grow-1 pe-3">
                            <Link className='redirect-link text-dark border-bottom' to={'/allCategory'}>
                                <li className="nav-item nav-link">All by Category</li>
                            </Link>
                            <Link className='redirect-link text-dark border-bottom' to={'/setting'}>
                                <li className="nav-item nav-link">Setting</li>
                            </Link>
                            <Link className='redirect-link text-dark border-bottom' to={'/'}>
                                <li className="nav-item nav-link">Shortcut Calculator</li>
                            </Link>
                            <Link className='redirect-link text-dark border-bottom' to={'/'}>
                                <li className="nav-item nav-link">About</li>
                            </Link>
                        </div>
                    </Offcanvas.Body>
                </Offcanvas>
            </div>
        </nav>
    );
}

export default SidebarToggle;


